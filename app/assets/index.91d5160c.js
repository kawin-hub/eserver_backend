import{j as J,k as b,Z as B,o as k,c as S,p as e,w as a,q as m,D as y,O as E,F as Z,a as K,b as Q,E as x,x as q,be as T,C as W,bd as X}from"./index.35991f09.js";import{u as H}from"./useLeadListStore.a2ed0901.js";import{u as Y}from"./useSaleCustomerLevelsListStore.567ead43.js";import{_ as ee}from"./confirm-dialog.bbba6032.js";import{r as w}from"./validators.9dda6c80.js";import{a as d,V as h}from"./VRow.f9366793.js";import{V as N,c as L,b as le}from"./VCard.bb37f72e.js";import{V as $}from"./VCombobox.bd903a82.js";import{V as ae}from"./VChip.81c7dee3.js";import{a as te}from"./VList.8e9051e1.js";import{V as f}from"./VTextField.4609cb9e.js";import{V as R}from"./VSelect.1bdb2ecc.js";import{V as O}from"./VBtn.3e0f2bdf.js";import{V as oe}from"./VDialog.61de6f6e.js";import{V as re}from"./position.15b8fc3a.js";import{V as de}from"./VSnackbar.34637b93.js";import{u as me}from"./useLineListStore.1d732fcb.js";import{b as A}from"./route-block.182765af.js";import{V as ue}from"./VForm.9ba2d763.js";import"./index.a44853ab.js";import"./DialogCloseBtn.9d70464b.js";import"./index.0d4b9ec4.js";import"./VAvatar.6ed53308.js";import"./router.88351000.js";import"./VImg.632117c3.js";import"./filter.f86a5c3d.js";import"./forwardRefs.c003b6b8.js";import"./VMenu.768d7784.js";import"./scopeId.a8f1d836.js";import"./VOverlay.a330b104.js";import"./lazy.7e795ed8.js";import"./easing.36b781ab.js";import"./dialog-transition.13a8c048.js";import"./VCheckboxBtn.a302f7e6.js";import"./VSelectionControl.6ac8e090.js";import"./VInput.6bf7b46e.js";import"./form.e84299e4.js";import"./index.a8f66a9c.js";import"./VDivider.0f44b1ce.js";/* empty css                   */import"./VField.93eb26cb.js";import"./VCounter.cb1a1153.js";const ie={__name:"basicInformationMain",props:{leadFormData:{type:Object},allLineProfile:{type:Object},lineProfile:{type:Object},leadFormDataOriginal:{type:Object},refForm:{type:Object}},emits:["update:leadFormData"],setup(I,{emit:C}){const t=I,s=J(),U=b([]),g=b(!1),c=b(!1),v=b({visible:!1,icon:"tabler-xbox-x",color:"error",title:"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A\u0E15\u0E32\u0E21\u0E17\u0E35\u0E48\u0E23\u0E30\u0E1A\u0E1A\u0E01\u0E33\u0E2B\u0E19\u0E14"}),_=b(null);B(()=>t.lineProfile,(p,o)=>{_.value=p});const P=()=>{var p,o;t.leadFormData.companyInfo[(o=(p=t.leadFormData)==null?void 0:p.companyInfo)==null?void 0:o.length]={companyName:"",taxId:"",branch:"",address:"",googleMap:"",companyEmail:"",companyContactNumber:"",firstname:"",lastname:"",contactNumber:""}};(()=>{Y.fetchData().then(p=>{if(p.data.code==1)for(var o=p.data.data.documents,V=0;V<o.length;V++)U.value[V]={title:o[V].level,value:o[V]._id}})})();const u=[{title:"Low prudential",value:"low prudential"},{title:"Middle prudential",value:"middle prudential"},{title:"High prudential",value:"high prudential"}],n=b([]),D=()=>{C("update:leadFormData",{...t.leadFormDataOriginal})},z=p=>{var o;(o=t.leadFormData)==null||o.companyInfo.splice(p,1)},G=()=>{var p;(p=t.refForm)==null||p.validate().then(async({valid:o})=>{if(o){c.value=!0,g.value=!0;let V=new FormData;for(const l in t.leadFormData)V.append(l,t.leadFormData[l]);H.updateItemJson(t.leadFormData).then(l=>{console.log(l.data),l.data.code==1?s.push({name:"projects-sale-tab",params:{tab:"leads"},query:{action:"addSuccess",topic:t.leadFormData.topic}}):v.value={visible:!0,icon:"tabler-xbox-x",color:"error",title:"\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E23\u0E30\u0E2B\u0E27\u0E48\u0E32\u0E07\u0E01\u0E32\u0E23\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 \u0E01\u0E23\u0E38\u0E13\u0E32\u0E41\u0E08\u0E49\u0E07\u0E40\u0E08\u0E49\u0E32\u0E2B\u0E19\u0E49\u0E32\u0E17\u0E35\u0E48\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E17\u0E33\u0E01\u0E32\u0E23\u0E41\u0E01\u0E49\u0E44\u0E02"}}).catch().finally(()=>{c.value=!1,g.value=!1})}else v.value={visible:!0,icon:"tabler-xbox-x",color:"error",title:"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A\u0E15\u0E32\u0E21\u0E17\u0E35\u0E48\u0E23\u0E30\u0E1A\u0E1A\u0E01\u0E33\u0E2B\u0E19\u0E14"}})};return B(_,()=>{_.value!==null?t.leadFormData.lineId=_.value.lineId:t.leadFormData.lineId=""}),(p,o)=>(k(),S("section",null,[e(h,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(N,{title:"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 Lead"},{default:a(()=>{var V;return[e(L,{class:"d-flex"},{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(N,{title:"\u0E04\u0E48\u0E32\u0E40\u0E23\u0E34\u0E48\u0E21\u0E15\u0E49\u0E19"},{default:a(()=>[e(L,{class:"pt-2"},{default:a(()=>[e(L,{class:"d-flex"},{default:a(()=>[e(h,null,{default:a(()=>[e(d,{cols:"12",md:"6"},{default:a(()=>[e($,{modelValue:m(_),"onUpdate:modelValue":o[0]||(o[0]=l=>y(_)?_.value=l:null),items:t.allLineProfile,"item-title":"name","item-value":"lineId",placeholder:"Line User",label:"\u0E40\u0E25\u0E37\u0E2D\u0E01 Line User",clearable:"","clear-icon":"tabler-x"},{chip:a(({props:l,item:i})=>[e(ae,E(l,{"prepend-avatar":i.raw.pictureUrl,text:i.raw.name}),null,16,["prepend-avatar","text"])]),item:a(({props:l,item:i})=>{var r,M,j;return[e(te,E(l,{"prepend-avatar":(r=i==null?void 0:i.raw)==null?void 0:r.pictureUrl,title:(M=i==null?void 0:i.raw)==null?void 0:M.name,subtitle:(j=i==null?void 0:i.raw)==null?void 0:j.lineId}),null,16,["prepend-avatar","title","subtitle"])]}),_:1},8,["modelValue","items"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:t.leadFormData.lineId,"onUpdate:modelValue":o[1]||(o[1]=l=>t.leadFormData.lineId=l),label:"Line ID",readonly:""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:t.leadFormData.level,"onUpdate:modelValue":o[2]||(o[2]=l=>t.leadFormData.level=l),label:" -- \u0E40\u0E25\u0E37\u0E2D\u0E01\u0E23\u0E30\u0E14\u0E31\u0E1A Lead -- ",items:u,"menu-props":{maxHeight:200}},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:t.leadFormData.customerLevel_id,"onUpdate:modelValue":o[3]||(o[3]=l=>t.leadFormData.customerLevel_id=l),label:" -- \u0E40\u0E25\u0E37\u0E2D\u0E01\u0E23\u0E30\u0E14\u0E31\u0E1A\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32 -- ",items:m(U),"item-title":"title","item-value":"value","menu-props":{maxHeight:200},rules:[m(w)(t.leadFormData.customerLevel_id,"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E23\u0E30\u0E14\u0E31\u0E1A\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32")]},null,8,["modelValue","items","rules"])]),_:1}),e(d,{cols:"12",md:"12"},{default:a(()=>[e($,{modelValue:t.leadFormData.tag,"onUpdate:modelValue":o[4]||(o[4]=l=>t.leadFormData.tag=l),chips:"",clearable:"",multiple:"","closable-chips":"","clear-icon":"tabler-circle-x",items:m(n),label:"Tag"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(k(!0),S(Z,null,K((V=t.leadFormData)==null?void 0:V.companyInfo,(l,i)=>(k(),Q(L,{class:"d-flex",key:i},{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(N,null,{default:a(()=>[e(le,{class:"v-expansion-panel-title"},{default:a(()=>[x("\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48\u0E17\u0E35\u0E48 "+q(i+1)+" ",1),e(ee,{title:"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E01\u0E32\u0E23\u0E25\u0E1A",data:{_id:`${i}`,name:`${l.companyName}`,body:`\u0E04\u0E38\u0E13\u0E15\u0E49\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E25\u0E1A ${l.companyName} \u0E08\u0E23\u0E34\u0E07\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48?`},callBack:z},null,8,["data"])]),_:2},1024),e(L,{class:"pt-2"},{default:a(()=>[e(h,null,{default:a(()=>[e(d,{md:"6",cols:"12"},{default:a(()=>[e(f,{modelValue:l.companyName,"onUpdate:modelValue":r=>l.companyName=r,label:"\u0E0A\u0E37\u0E48\u0E2D\u0E1A\u0E23\u0E34\u0E29\u0E31\u0E17 ",rules:[m(w)(l.companyName,"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E0A\u0E37\u0E48\u0E2D\u0E1A\u0E23\u0E34\u0E29\u0E31\u0E17")]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.branch,"onUpdate:modelValue":r=>l.branch=r,label:"\u0E2A\u0E32\u0E02\u0E32"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.taxId,"onUpdate:modelValue":r=>l.taxId=r,label:"\u0E40\u0E25\u0E02\u0E1B\u0E23\u0E30\u0E08\u0E33\u0E15\u0E31\u0E27\u0E1C\u0E39\u0E49\u0E40\u0E2A\u0E35\u0E22\u0E20\u0E32\u0E29\u0E35"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.address,"onUpdate:modelValue":r=>l.address=r,label:"\u0E17\u0E35\u0E48\u0E15\u0E31\u0E49\u0E07"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.googleMap,"onUpdate:modelValue":r=>l.googleMap=r,label:"Google map"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.companyEmail,"onUpdate:modelValue":r=>l.companyEmail=r,label:"Email"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.companyContactNumber,"onUpdate:modelValue":r=>l.companyContactNumber=r,label:"\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23\u0E28\u0E31\u0E1E\u0E17\u0E4C"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{md:"6",cols:"12"},{default:a(()=>[e(f,{modelValue:l.firstname,"onUpdate:modelValue":r=>l.firstname=r,label:"\u0E0A\u0E37\u0E48\u0E2D\u0E1C\u0E39\u0E49\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2D",rules:[m(w)(l.firstname,"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E0A\u0E37\u0E48\u0E2D\u0E1C\u0E39\u0E49\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2D")]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(d,{md:"6",cols:"12"},{default:a(()=>[e(f,{modelValue:l.lastname,"onUpdate:modelValue":r=>l.lastname=r,label:"\u0E19\u0E32\u0E21\u0E2A\u0E01\u0E38\u0E25\u0E1C\u0E39\u0E49\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2D"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{cols:"12",md:"6"},{default:a(()=>[e(f,{modelValue:l.contactNumber,"onUpdate:modelValue":r=>l.contactNumber=r,label:"\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23\u0E28\u0E31\u0E1E\u0E17\u0E4C\u0E1C\u0E39\u0E49\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2D",rules:[m(w)(l.contactNumber,"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23\u0E28\u0E31\u0E1E\u0E17\u0E4C\u0E1C\u0E39\u0E49\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2D")]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(L,{class:"d-flex"},{default:a(()=>[e(d,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(O,{onClick:G,disabled:m(g)},{default:a(()=>[x(" \u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25")]),_:1},8,["disabled"]),e(O,{color:"secondary",variant:"tonal",type:"reset",onClick:T(D,["prevent"])},{default:a(()=>[x(" \u0E25\u0E49\u0E32\u0E07\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 ")]),_:1},8,["onClick"]),e(O,{onClick:T(P,["prevent"])},{default:a(()=>[x("\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48\u0E43\u0E2B\u0E21\u0E48")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(oe,{modelValue:m(c),"onUpdate:modelValue":o[5]||(o[5]=l=>y(c)?c.value=l:null),persistent:"",width:"300"},{default:a(()=>[e(N,{color:"primary",width:"300"},{default:a(()=>[e(L,{class:"pt-3"},{default:a(()=>[x(" \u0E01\u0E33\u0E25\u0E31\u0E07\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 \u0E01\u0E23\u0E38\u0E13\u0E32\u0E23\u0E2D\u0E0B\u0E31\u0E01\u0E04\u0E23\u0E39\u0E48 "),e(re,{indeterminate:"",color:"white",class:"mb-0"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(de,{modelValue:m(v).visible,"onUpdate:modelValue":o[6]||(o[6]=l=>m(v).visible=l),location:"bottom end"},{default:a(()=>[e(W,{icon:m(v).icon,color:m(v).color,size:"30"},null,8,["icon","color"]),x(" \xA0 "+q(m(v).title),1)]),_:1},8,["modelValue"])]}),_:1})]),_:1})]),_:1})]))}},ne={__name:"index",setup(I){const C=X(),t=b(),s={_id:null,companyInfo_id:null,companyInfo:{companyName:"",taxId:"",branch:"",address:"",googleMap:"",companyEmail:"",companyContactNumber:"",firstname:"",lastname:"",contactNumber:""},customerLevel_id:"",lineId:"",level:"",customerLevel:"",tag:""},U=b([]),g=b(null),c=b(structuredClone(s)),v=async()=>{const F=C.query._id;typeof F==null||await H.fetchData("?_id="+F).then(u=>{if(u.data.code==1){const D=u.data.data;s._id=C.query._id,s.companyInfo=D.companyInfo;for(var n=0;n<D.companyInfo.length;n++)s.companyInfo_id=D.companyInfo[n]._id;s.lineId=D.lineId,s.level=D.level,s.customerLevel_id=D.customerLevel.customerLevel_id,s.tag=D.tag,c.value=structuredClone(s)}})},_=async()=>{await me.fetchData("/users").then(F=>{if(F.data.code==1){var u=F.data.data;U.value=u}})};async function P(){await Promise.all([_(),v()]),g.value=U.value.find(F=>F.lineId===c.value.lineId)}return P(),(F,u)=>(k(),S("section",null,[e(ue,{ref_key:"refForm",ref:t,class:"mt-6"},{default:a(()=>[e(ie,{leadFormData:m(c),"onUpdate:leadFormData":u[0]||(u[0]=n=>y(c)?c.value=n:null),allLineProfile:m(U),"onUpdate:allLineProfile":u[1]||(u[1]=n=>y(U)?U.value=n:null),lineProfile:m(g),"onUpdate:lineProfile":u[2]||(u[2]=n=>y(g)?g.value=n:null),leadFormDataOriginal:s,"onUpdate:leadFormDataOriginal":u[3]||(u[3]=n=>s=n),refForm:m(t),"onUpdate:refForm":u[4]||(u[4]=n=>y(t)?t.value=n:null)},null,8,["leadFormData","allLineProfile","lineProfile","refForm"])]),_:1},512)]))}};typeof A=="function"&&A(ne);export{ne as default};
